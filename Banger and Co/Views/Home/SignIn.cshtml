@{
    ViewData["Title"] = "Sign In";
}

@model ViewModel

@if (Model.ErrorMessage != null)
{
    <h3 id="loginerror" hidden>@Model.ErrorMessage</h3>
}

<div class="signin">
    <div class="signin_banner">
        <div>
            <svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 353.7 38.25">
                <defs>
                    <linearGradient id="grad1" x1="0%" y1="0%" x2="100%" y2="0%">
                        <stop offset="0%" style="stop-color:rgb(16, 37, 58);stop-opacity:1"></stop>
                        <stop offset="100%" style="stop-color:rgb(28, 67, 104);stop-opacity:1"></stop>
                    </linearGradient>
                </defs>
                <path class="cls-1" d="M298.41,493.77V464.32h22.8c3.13,0,5.42.62,6.85,1.87a5.81,5.81,0,0,1,2.15,4.53v1.5a5.92,5.92,0,0,1-.88,3.37,5.49,5.49,0,0,1-1.87,1.88,6.87,6.87,0,0,1,3.5,2.42,7.31,7.31,0,0,1,1.3,4.53v.9a13.35,13.35,0,0,1-.35,3,6.59,6.59,0,0,1-1.33,2.72,6.68,6.68,0,0,1-2.75,2,12,12,0,0,1-4.62.75Zm9.75-18.1h10a2.35,2.35,0,0,0,1.8-.55,2.17,2.17,0,0,0,.5-1.5v-.5a2,2,0,0,0-.5-1.5,3.68,3.68,0,0,0-2.25-.45h-9.55Zm0,11.25h12a2.59,2.59,0,0,0,1.8-.48,2,2,0,0,0,.5-1.52V484a1.81,1.81,0,0,0-.65-1.48,3.65,3.65,0,0,0-2.25-.52H308.16Z" transform="translate(-298.41 -464.32)" />
                <path class="cls-1" d="M345.71,493.77q-4.4,0-6.3-1.65t-1.9-5.5c0-2.37.66-4.08,2-5.15s3.4-1.6,6.23-1.6h1.55c1.87,0,3.65.07,5.35.2s3.17.27,4.4.4v-.8a3.16,3.16,0,0,0-.3-1.35c-.2-.43-.9-.65-2.1-.65h-2.5q-5.44,0-8.4.17a35.27,35.27,0,0,0-3.65.33l-.55-5.3c0-.33.58-.61,1.75-.83a42.75,42.75,0,0,1,4.8-.5q3-.17,6.95-.17h5a10.57,10.57,0,0,1,5.05,1,5.13,5.13,0,0,1,2.4,2.63,10.4,10.4,0,0,1,.65,3.8v15H359l-1.95-1c-.8.17-2.08.37-3.83.62a42.85,42.85,0,0,1-6,.38Zm2.9-5.9h6.9a2.39,2.39,0,0,0,1.3-.2,2.24,2.24,0,0,0,.2-1.25v-1.75h-8.4a2.31,2.31,0,0,0-1.4.35,1.63,1.63,0,0,0-.45,1.35c0,.63.15,1,.45,1.22A2.69,2.69,0,0,0,348.61,487.87Z" transform="translate(-298.41 -464.32)" />
                <path class="cls-1" d="M371.86,493.77v-22.4h7.25l2,1c1.4-.27,3.09-.5,5.07-.7s3.85-.3,5.58-.3h2.5a8.48,8.48,0,0,1,3.85.7,4.4,4.4,0,0,1,1.92,1.75,5.64,5.64,0,0,1,.7,2.12,15,15,0,0,1,.13,1.83v16h-9.15v-14.1c0-1.33-.8-2-2.4-2h-6.7a2.88,2.88,0,0,0-1.23.17q-.27.18-.27.93v15Z" transform="translate(-298.41 -464.32)" />
                <path class="cls-1" d="M422.06,502.57q-5.15,0-8.4-.18a44.93,44.93,0,0,1-5-.47,8,8,0,0,1-2.4-.68c-.43-.25-.65-.49-.65-.72l2.5-5.25c.37.1,1.18.29,2.45.57a26.71,26.71,0,0,0,5.55.43h7.55a3,3,0,0,0,1.87-.45,1.75,1.75,0,0,0,.53-1.55v-2a25,25,0,0,1-4.33.72,64.25,64.25,0,0,1-6.47.28h-1.45a10.23,10.23,0,0,1-4.93-.93,4.44,4.44,0,0,1-2.15-2.57,13.13,13.13,0,0,1-.52-4v-7a12.32,12.32,0,0,1,.27-2.5,6.61,6.61,0,0,1,1-2.4,5.69,5.69,0,0,1,2.3-1.8,9.59,9.59,0,0,1,4-.7h1.5c2.33,0,4.23,0,5.7.1s2.64.15,3.52.25,1.63.2,2.23.3l1.3-.65h7.1v23.8a7.15,7.15,0,0,1-2.1,5.35q-2.1,2.06-7,2.05Zm-4.2-15.65h6.65a2.53,2.53,0,0,0,1.35-.2,2.39,2.39,0,0,0,.2-1.3V478l-2.13-.18c-.68,0-1.45-.09-2.3-.12s-1.92-.05-3.22-.05h-.55c-1.6,0-2.4.67-2.4,2v5.25C415.43,486.25,416.23,486.92,417.86,486.92Z" transform="translate(-298.41 -464.32)" />
                <path class="cls-1" d="M448.81,493.77a11,11,0,0,1-5.08-.95,5,5,0,0,1-2.42-2.63,10.67,10.67,0,0,1-.65-3.87v-7.55a9.79,9.79,0,0,1,.67-3.68,5.54,5.54,0,0,1,2.43-2.7,10.17,10.17,0,0,1,5.05-1h10.35a15.28,15.28,0,0,1,6,.92,5.35,5.35,0,0,1,2.85,2.6,9.11,9.11,0,0,1,.78,3.88v6.4H460q-4.5,0-6.83-.2c-1.55-.13-2.64-.22-3.27-.25v.75c0,1.33.77,2,2.4,2h1.55q4,0,7.4-.18c2.26-.11,3.95-.22,5.05-.32l3,4.75c0,.33-.29.65-.85.95a10.19,10.19,0,0,1-3,.77,41.69,41.69,0,0,1-6,.33Zm1.1-13.4h9.6v-.7a3.78,3.78,0,0,0-.18-1.4c-.11-.27-.47-.43-1.07-.5s-1.62-.1-3.05-.1h-2.9c-1.6,0-2.4.67-2.4,2Z" transform="translate(-298.41 -464.32)" />
                <path class="cls-1" d="M474.31,493.77v-22.4h7.1l1.9,1a11,11,0,0,1,6.1-1.5,16.6,16.6,0,0,1,4.4.52,16.37,16.37,0,0,1,3.07,1.13,9.53,9.53,0,0,1,1.48.85l-2.5,6.5a12.88,12.88,0,0,0-1.88-.95,25.28,25.28,0,0,0-3.22-1.13,14.24,14.24,0,0,0-3.9-.52h-.55a4.11,4.11,0,0,0-2.15.47c-.5.32-.75,1-.75,2.08v13.95Z" transform="translate(-298.41 -464.32)" />
                <path class="cls-1" d="M546.81,494.27A27.86,27.86,0,0,1,543,494a10.08,10.08,0,0,1-3-.9,16.54,16.54,0,0,1-3-1.92,13.1,13.1,0,0,1-2.15,1.27,11.36,11.36,0,0,1-3,.9,26.66,26.66,0,0,1-4.65.33h-5.75a9.05,9.05,0,0,1-4-.75,6,6,0,0,1-2.3-1.85,6.71,6.71,0,0,1-1-2.3,9.73,9.73,0,0,1-.27-2.1v-4.2a7.64,7.64,0,0,1,1.47-4.93,7.44,7.44,0,0,1,4.23-2.47,5.19,5.19,0,0,1-.88-1.45,6.55,6.55,0,0,1-.47-2.65v-.7a5.76,5.76,0,0,1,1.8-4.2q1.8-1.8,5.85-1.8h7.75a10.94,10.94,0,0,1,4.92.85,4.34,4.34,0,0,1,2.15,2.12,6.86,6.86,0,0,1,.53,2.63V472a2.24,2.24,0,0,1-.55,1.55,2.07,2.07,0,0,1-1.6.6h-6.9v-1.2a2.1,2.1,0,0,0-.38-1.33,1.69,1.69,0,0,0-1.37-.47h-1.2c-.8,0-1.2.33-1.2,1,0,1.13.71,2.2,2.15,3.2,1.06.73,2.11,1.48,3.12,2.25s2.08,1.63,3.18,2.6q1,.9,1.77,1.62l.88.88.5-.35v-6.9l10,.7v4.1a5.49,5.49,0,0,1-.28,1.85,4.56,4.56,0,0,1-1.12,1.65,9,9,0,0,1-1.75,1.25c-.8.47-1.52.85-2.15,1.15a13.52,13.52,0,0,0,2.82,1.67,15.85,15.85,0,0,0,2.85,1,14.35,14.35,0,0,0,2,.35l-.6,4.6a14.63,14.63,0,0,1-2,.37A19.45,19.45,0,0,1,546.81,494.27Zm-21.3-7.45h4.9a4.73,4.73,0,0,0,1.4-.13,2,2,0,0,0,.4-.17,33,33,0,0,0-2.6-2.3q-1.56-1.25-3-2.25a5.44,5.44,0,0,0-1-.55,2.31,2.31,0,0,0-.87-.2q-1.2,0-1.2,1.65v1.95a2.22,2.22,0,0,0,.42,1.57A2.12,2.12,0,0,0,525.51,486.82Z" transform="translate(-298.41 -464.32)" />
                <path class="cls-1" d="M578.71,493.77q-5.36,0-7.75-2.35t-2.4-7.6v-9.15q0-5.4,2.65-7.88t7.5-2.47h14.6a28,28,0,0,1,5.27.37q1.83.38,1.83.78l-1.55,6.25c-.84-.1-2.46-.21-4.88-.33s-5.46-.17-9.12-.17h-2.55q-2.35,0-3.18.87a3.8,3.8,0,0,0-.82,2.68v8.55a4.17,4.17,0,0,0,.72,2.62c.48.62,1.58.93,3.28.93h2.05c4.76,0,8.4-.06,10.9-.18a33,33,0,0,0,4.5-.37l3,5.4c0,.17-.35.42-1,.75a13.9,13.9,0,0,1-3.45.9,43.27,43.27,0,0,1-6.72.4Z" transform="translate(-298.41 -464.32)" />
                <path class="cls-1" d="M614,493.77a10.2,10.2,0,0,1-5-.95,4.53,4.53,0,0,1-2.18-2.63,12.9,12.9,0,0,1-.52-3.87v-7.55a12,12,0,0,1,.55-3.78,4.77,4.77,0,0,1,2.17-2.65,9.81,9.81,0,0,1,4.93-1h13.9a9.77,9.77,0,0,1,4.92,1,4.69,4.69,0,0,1,2.15,2.65,12.65,12.65,0,0,1,.53,3.78v7.55a12.89,12.89,0,0,1-.53,3.87,4.56,4.56,0,0,1-2.15,2.63,10,10,0,0,1-4.92.95Zm4-6.3h5.95c1.6,0,2.38-.67,2.35-2v-5.8a2,2,0,0,0-.53-1.5,2.64,2.64,0,0,0-1.82-.5H618a2.73,2.73,0,0,0-1.85.5,1.91,1.91,0,0,0-.55,1.5v5.8C615.57,486.8,616.36,487.47,618,487.47Z" transform="translate(-298.41 -464.32)" />
                <path class="cls-1" d="M647,493.77q-5.06,0-5-4.3a3.86,3.86,0,0,1,1.27-3.33,8.41,8.41,0,0,1,7.65,0,3.94,3.94,0,0,1,1.23,3.33Q652.11,493.78,647,493.77Z" transform="translate(-298.41 -464.32)" />
            </svg>
            <label>FOR ALL YOUR VEHICLE NEEDS</label>
        </div>
    </div>
    <div class="signin_form">
        <table>
            <tr>
                <td>
                    <label>SIGN IN</label>
                </td>
            </tr>
            <tr>
                <td>
                    <label id="error" class="error_block"></label>
                </td>
            </tr>
            <tr>
                <td>
                    <input class="signin_form_email" type="email" placeholder="E-mail Address" name="email" id="email" required>
                </td>
            </tr>
            <tr>
                <td>
                    <input class="signin_form_pwd" type="password" placeholder="Password" name="pwd" id="pwd" required><br>
                    <label class="signin_form_forgotpwd">Forgot your password? <a href="">Reset password</a></label>
                </td>
            </tr>
            <tr>
                <td>
                    <button class="signin_form_login" type="submit">Login</button><br>
                    <label class="signin_form_join">Don't have an account? <a href="/Home/Join">Join us</a></label>
                </td>
            </tr>
        </table>
    </div>
</div>

<script>
    $(document).ready(function () {
        $(".signin_form_login_loading").hide();

        var text = $("#loginerror").text();

        if (text != "") {
            alert(text);
        }
    });

    $(".signin_form_login").click(function () {
        var email = $("#email").val();
        var password = $("#pwd").val();

        if (email != "" && password != "") {
            if ($("#error").hasClass("active")) {
                $("#error").removeClass("active");
            }

            $("input[class^=signin_form]").each(function () {
                $(this).css("border", "2px solid gray");
            });

            $.ajax({
                type: "POST",
                url: '/User/SignIn?email=' + email + '&password=' + password,
                dataType: "json",
                contentType: "application/json; charset=utf-8",
                success: function (data) {
                    if (data == "Please enter valid login credentials") {
                        $("#error").text("Please enter valid login credentials");
                        $("#error").addClass("active"); 
                    }
                    else {
                        if (data == "Home") {
                            window.location.href = "/Home"
                        }
                        else {
                            window.location.href = "/Admin"
                        }
                    }
                },
                error: function () {
                    alert("Something went wrong");
                }
            });
            return false;
        }
        else {
            $("#error").text("Please fill all fields");
            $("#error").addClass("active");
            $("input[class^=signin_form]").each(function () {
                if ($(this).val() == "") {
                    $(this).css("border", "2px solid red");
                }
                else {
                    $(this).css("border", "2px solid gray");
                }
            });
            if ($("#error").prop("hidden") == false) {
                $("#error").prop("hidden", true);
            }
        }
    });
</script>